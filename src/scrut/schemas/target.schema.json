{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://scrut.dev/schemas/v1/target.schema.json",
  "title": "Target",
  "description": "Evidence source registered within a case",
  "type": "object",
  "required": ["target_id", "case_id", "name", "type", "path", "hash_sha256", "size_bytes", "added_at", "status"],
  "properties": {
    "target_id": {
      "type": "string",
      "format": "uuid",
      "description": "Unique identifier (UUID v4)"
    },
    "case_id": {
      "type": "string",
      "format": "uuid",
      "description": "Parent case reference"
    },
    "name": {
      "type": "string",
      "minLength": 1,
      "description": "Target display name"
    },
    "type": {
      "type": "string",
      "enum": ["image", "folder", "collection", "output"],
      "description": "Target type"
    },
    "path": {
      "type": "string",
      "description": "Absolute path to target"
    },
    "format": {
      "type": "string",
      "description": "Specific format (E01, raw, VMDK, etc.)"
    },
    "hash_sha256": {
      "type": "string",
      "pattern": "^[a-f0-9]{64}$",
      "description": "SHA-256 hash of target"
    },
    "size_bytes": {
      "type": "integer",
      "minimum": 0,
      "description": "Total size in bytes"
    },
    "added_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 registration timestamp"
    },
    "indexed_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO-8601 indexing completion timestamp"
    },
    "status": {
      "type": "string",
      "enum": ["pending", "indexed", "error"],
      "description": "Target indexing status"
    },
    "metadata": {
      "type": "object",
      "additionalProperties": true,
      "description": "Target-specific metadata"
    }
  },
  "additionalProperties": false
}
